<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div id="parent">
      <div id="children">孩子</div>
    </div>
    <script>
      function dispatchEvent(event) {
        let paths = []
        let current = event.target
        while (current) {
          paths.push(current)
          current = current.parentNode
        }
        // 模拟捕获和冒泡 其实这个时候原生的捕获阶段已结束
        for (let index = paths.length - 1; index >= 0; index--) {
          const handler = paths[index].onClickCapture
          handler && handler()
        }
        for (let index = 0; index < paths.length; index++) {
          const handler = paths[index].onClick
          handler && handler()
        }
      }
      // 注册React事件的事件委托
      document.addEventListener('click', dispatchEvent)
      const parent = document.getElementById('parent')
      const children = document.getElementById('children')

      document.addEventListener(
        'click',
        () => {
          console.log('document原生捕获')
        },
        true,
      )
      document.addEventListener('click', () => {
        console.log('document原生冒泡')
      })
      parent.addEventListener(
        'click',
        () => {
          console.log('父元素原生捕获')
        },
        true,
      )
      parent.addEventListener('click', () => {
        console.log('父元素原生冒泡')
      })
      children.addEventListener(
        'click',
        () => {
          console.log('子元素原生捕获')
        },
        true,
      )
      children.addEventListener('click', () => {
        console.log('子元素原生冒泡')
      })

      parent.onClick = function () {
        console.log('父亲元素React事件冒泡')
      }
      parent.onClickCapture = function () {
        console.log('父亲元素React事件捕获')
      }
      children.onClick = function () {
        console.log('子元素React事件捕获')
      }
      children.onClickCapture = function () {
        console.log('子元素React事件冒泡')
      }
    </script>
  </body>
</html>
